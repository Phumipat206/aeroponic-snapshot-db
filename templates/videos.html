{% extends "base.html" %}

{% block page_title %}My Videos{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <i class="fas fa-video"></i>
        <h2>Generated Videos</h2>
    </div>
    
    {% if videos %}
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Filename</th>
                    <th>Images</th>
                    <th>FPS</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for video in videos %}
                <tr>
                    <td><span class="badge badge-secondary">{{ video.id }}</span></td>
                    <td>
                        <i class="fas fa-film" style="color: var(--primary); margin-right: 8px;"></i>
                        <span style="word-break:break-all">{{ video.video_filename }}</span>
                    </td>
                    <td><span class="badge badge-primary">{{ video.snapshot_count }}</span></td>
                    <td>{{ video.fps }} FPS</td>
                    <td>{{ video.created_at[:16] }}</td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <a href="/video/{{ video.id }}" class="btn" style="padding: 8px 16px; font-size: 0.85rem;">
                                <i class="fas fa-download"></i> Download
                            </a>
                            <form action="/video/{{ video.id }}/delete" method="POST" style="display: inline;"
                                  onsubmit="return confirm('Are you sure you want to delete this video?');">
                                <button type="submit" style="padding: 8px 16px; font-size: 0.85rem; background: var(--danger);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-video-slash"></i>
        <h3>No Videos Yet</h3>
        <p>Create a time-lapse video from your snapshots</p>
        <a href="/generate-video" class="btn" style="margin-top: 1rem;">
            <i class="fas fa-plus"></i> Create New Video
        </a>
    </div>
    {% endif %}
</div>

<!-- Create New Video -->
<div class="card">
    <div class="card-header">
        <i class="fas fa-plus-circle"></i>
        <h2>Create New Video</h2>
    </div>
    <p style="color: var(--gray); margin-bottom: 1rem;">Create a time-lapse video from snapshots in the database</p>
    <a href="/generate-video" class="btn">
        <i class="fas fa-film"></i> Go to Video Creator
    </a>
</div>
{% endblock %}

{% block extra_css %}
<style>
@media (max-width: 640px) {
    .table-container {
        margin: 0 -16px;
        width: calc(100% + 32px);
        border-radius: 0;
    }
    
    table thead {
        display: none;
    }
    
    table tbody tr {
        display: block;
        padding: 16px;
        border-bottom: 1px solid var(--border);
    }
    
    table tbody tr:last-child {
        border-bottom: none;
    }
    
    table tbody td {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border: none;
    }
    
    table tbody td::before {
        content: attr(data-label);
        font-weight: 600;
        color: var(--gray);
        font-size: 12px;
    }
    
    table tbody td:nth-child(1)::before { content: "ID"; }
    table tbody td:nth-child(2)::before { content: "File"; }
    table tbody td:nth-child(3)::before { content: "Images"; }
    table tbody td:nth-child(4)::before { content: "FPS"; }
    table tbody td:nth-child(5)::before { content: "Created"; }
    table tbody td:nth-child(6)::before { content: ""; }
    
    table tbody td:nth-child(6) {
        justify-content: center;
        padding-top: 12px;
    }
    
    table tbody td:nth-child(6) > div {
        width: 100%;
        justify-content: center;
    }
    
    table tbody td:nth-child(6) .btn,
    table tbody td:nth-child(6) button {
        flex: 1;
        padding: 12px !important;
    }
}
</style>
{% endblock %}
