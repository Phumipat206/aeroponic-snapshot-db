<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Aeroponic Snapshot Database{% endblock %}</title>
    <link rel="icon" type="image/png" href="/static/images/logo.png">
    <link rel="apple-touch-icon" href="/static/images/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #eff6ff;
            --primary-50: #dbeafe;
            --secondary: #64748b;
            --dark: #0f172a;
            --gray-700: #334155;
            --gray-600: #475569;
            --gray-500: #64748b;
            --gray-400: #94a3b8;
            --gray-300: #cbd5e1;
            --gray-200: #e2e8f0;
            --gray-100: #f1f5f9;
            --gray-50: #f8fafc;
            --white: #ffffff;
            --danger: #ef4444;
            --danger-light: #fef2f2;
            --success: #22c55e;
            --success-light: #f0fdf4;
            --warning: #f59e0b;
            --warning-light: #fffbeb;
            --accent: #f59e0b;
            --surface: #ffffff;
            --background: #f8fafc;
            --border: #e2e8f0;
            --shadow-xs: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1),0 1px 2px rgba(0,0,0,0.06);
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);
            --shadow-lg: 0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04);
            --radius: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --nav-w: 256px;
            --topbar-h: 60px;
        }
        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
        html{scroll-behavior:smooth}
        html,body{width:100%;max-width:100vw;overflow-x:hidden}
        img{max-width:100%;height:auto}
        body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;line-height:1.6;color:var(--dark);background:var(--background);min-height:100vh}

        /* ===== App Layout ===== */
        .app-layout{display:flex;min-height:100vh}

        /* ===== Sidebar ===== */
        .sidebar{position:fixed;top:0;left:0;width:var(--nav-w);height:100vh;background:var(--white);border-right:1px solid var(--border);display:flex;flex-direction:column;z-index:1000;transition:transform .3s cubic-bezier(.4,0,.2,1)}
        .sidebar-header{padding:20px 16px 16px;border-bottom:1px solid var(--border)}
        .sidebar-logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--dark)}
        .sidebar-logo-icon{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden;padding:0}
        .sidebar-logo-icon img{width:100%;height:100%;object-fit:contain}
        .sidebar-logo-text{font-size:15px;font-weight:700;line-height:1.2}
        .sidebar-logo-text small{display:block;font-size:11px;font-weight:400;color:var(--gray-500);margin-top:1px}
        .sidebar-nav{flex:1;overflow-y:auto;padding:10px 8px}
        .nav-section{margin-bottom:6px}
        .nav-section-title{font-size:10px;font-weight:600;color:var(--gray-400);text-transform:uppercase;letter-spacing:.6px;padding:8px 12px 4px}
        .nav-link{display:flex;align-items:center;gap:10px;padding:9px 12px;color:var(--gray-600);text-decoration:none;border-radius:var(--radius);font-size:13.5px;font-weight:500;transition:all .15s;margin-bottom:1px}
        .nav-link:hover{background:var(--gray-100);color:var(--dark)}
        .nav-link.active{background:var(--primary-light);color:var(--primary)}
        .nav-link.active i{color:var(--primary)}
        .nav-link i{width:18px;text-align:center;font-size:15px;color:var(--gray-400)}
        .nav-link:hover i{color:var(--gray-600)}
        .sidebar-footer{padding:10px 16px;border-top:1px solid var(--border);font-size:10px;color:var(--gray-400);text-align:center}
        .sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.35);z-index:999}
        .sidebar-overlay.show{display:block}

        /* ===== Main Content ===== */
        .main-content{flex:1;margin-left:var(--nav-w);min-height:100vh;display:flex;flex-direction:column}
        .topbar{position:sticky;top:0;z-index:900;background:rgba(248,250,252,.88);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:0 24px;height:var(--topbar-h);display:flex;align-items:center;justify-content:space-between}
        .topbar-title{font-size:17px;font-weight:600;color:var(--dark)}
        .mobile-menu-btn{display:none;background:none;border:none;padding:8px;cursor:pointer;color:var(--gray-600);font-size:20px;border-radius:var(--radius);min-height:auto}
        .mobile-menu-btn:hover{background:var(--gray-100);color:var(--dark);box-shadow:none}
        .page-content{flex:1;padding:24px;max-width:1200px;width:100%;margin:0 auto}
        .container{width:100%;max-width:100%}

        /* ===== Cards ===== */
        .card{background:var(--white);border-radius:var(--radius-lg);border:1px solid var(--border);padding:24px;margin-bottom:16px;transition:box-shadow .2s}
        .card:hover{box-shadow:var(--shadow-xs)}
        .card-header{display:flex;align-items:center;gap:12px;margin-bottom:16px;padding-bottom:14px;border-bottom:1px solid var(--gray-100)}
        .card-header i{font-size:18px;color:var(--primary);width:34px;height:34px;background:var(--primary-light);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .card h2{color:var(--dark);font-weight:600;font-size:16px}

        /* ===== Help Box ===== */
        .help-box{background:var(--primary-light);border:1px solid var(--primary-50);border-radius:var(--radius-lg);padding:16px 20px;margin-bottom:16px;font-size:13.5px;color:var(--gray-700);line-height:1.7}
        .help-box h3{font-size:14px;font-weight:600;color:var(--primary);margin-bottom:6px;display:flex;align-items:center;gap:8px}
        .help-box ul{margin:6px 0 0 20px}
        .help-box ul li{margin-bottom:3px}
        .help-toggle{display:inline-flex;align-items:center;gap:6px;font-size:12px;color:var(--primary);cursor:pointer;font-weight:500;padding:5px 12px;border-radius:20px;background:var(--primary-light);border:none;transition:all .15s;min-height:auto}
        .help-toggle:hover{background:var(--primary-50);box-shadow:none}

        /* ===== Forms ===== */
        .form-group{margin-bottom:20px}
        label{display:block;margin-bottom:6px;font-weight:500;color:var(--gray-700);font-size:13.5px}
        input[type="text"],input[type="number"],input[type="datetime-local"],input[type="date"],input[type="time"],input[type="file"],select,textarea{width:100%;padding:10px 14px;border:1px solid var(--gray-300);border-radius:var(--radius);font-size:14px;font-family:inherit;transition:all .15s;background:var(--white);color:var(--dark)}
        input:focus,select:focus,textarea:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(37,99,235,.1)}
        input[type="file"]{padding:10px;cursor:pointer;background:var(--gray-50)}
        .form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}

        /* ===== Buttons ===== */
        .btn,button[type="submit"]{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 20px;border:none;border-radius:var(--radius);cursor:pointer;font-size:14px;font-weight:500;font-family:inherit;transition:all .15s;text-decoration:none;background:var(--primary);color:#fff}
        .btn:hover,button[type="submit"]:hover{background:var(--primary-dark);box-shadow:var(--shadow-sm)}
        .btn-secondary{background:var(--white);color:var(--primary);border:1px solid var(--gray-300)}
        .btn-secondary:hover{background:var(--primary-light);border-color:var(--primary)}
        .btn-outline{background:transparent;border:1px solid var(--primary);color:var(--primary)}
        .btn-outline:hover{background:var(--primary-light)}
        .btn-danger{background:var(--danger)}
        .btn-danger:hover{background:#dc2626}
        .btn-sm{padding:6px 14px;font-size:13px}
        button:disabled{opacity:.5;cursor:not-allowed}

        /* ===== Alerts ===== */
        .alert{padding:13px 16px;border-radius:var(--radius);margin-bottom:16px;display:flex;align-items:flex-start;gap:10px;font-size:14px}
        .alert-success{background:var(--success-light);color:#15803d;border:1px solid #bbf7d0}
        .alert-error{background:var(--danger-light);color:#b91c1c;border:1px solid #fecaca}
        .alert-warning{background:var(--warning-light);color:#92400e;border:1px solid #fde68a}
        .alert-info{background:var(--primary-light);color:var(--primary);border:1px solid var(--primary-50)}

        /* ===== Stats Grid ===== */
        .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
        .stat-card{background:var(--white);padding:20px;border-radius:var(--radius-lg);border:1px solid var(--border);position:relative;overflow:hidden}
        .stat-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--primary)}
        .stat-card:nth-child(2)::before{background:var(--success)}
        .stat-card:nth-child(3)::before{background:var(--accent)}
        .stat-card:nth-child(4)::before{background:var(--danger)}
        .stat-card h3{font-size:30px;font-weight:700;color:var(--dark);margin-bottom:2px}
        .stat-card p{color:var(--gray-500);font-size:13px;font-weight:500}
        .stat-card p i{margin-right:4px}

        /* ===== Grid ===== */
        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;margin-top:16px}

        /* ===== Snapshot Cards ===== */
        .snapshot-card{background:var(--white);border-radius:var(--radius-lg);overflow:hidden;border:1px solid var(--border);transition:all .2s;position:relative}
        .snapshot-card:hover{box-shadow:var(--shadow);transform:translateY(-2px)}
        .snapshot-card img{width:100%;height:180px;object-fit:cover}
        .snapshot-card .info{padding:14px}
        .snapshot-card .info h3{font-size:14px;margin-bottom:6px;color:var(--dark);font-weight:600}
        .snapshot-card .info p{font-size:12px;color:var(--gray-500);margin:3px 0;display:flex;align-items:center;gap:6px}
        .snapshot-card .info p i{color:var(--gray-400);width:14px;font-size:12px}

        /* ===== Table ===== */
        .table-container{overflow-x:auto;border-radius:var(--radius-lg);border:1px solid var(--border)}
        table{width:100%;border-collapse:collapse;background:var(--white)}
        th,td{padding:12px 16px;text-align:left;font-size:14px}
        th{background:var(--gray-50);color:var(--gray-600);font-weight:600;border-bottom:1px solid var(--border)}
        td{border-bottom:1px solid var(--gray-100);color:var(--dark)}
        tr:hover td{background:var(--gray-50)}
        tr:last-child td{border-bottom:none}

        /* ===== Quick Actions ===== */
        .quick-actions{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px;margin-top:16px}
        .action-btn{display:flex;flex-direction:column;align-items:center;gap:10px;padding:24px 12px;background:var(--white);border:1px solid var(--border);border-radius:var(--radius-lg);text-decoration:none;color:var(--gray-700);font-weight:500;font-size:13px;transition:all .2s}
        .action-btn:hover{background:var(--primary-light);border-color:var(--primary);color:var(--primary);transform:translateY(-2px);box-shadow:var(--shadow-sm)}
        .action-btn i{font-size:26px;color:var(--primary)}

        /* ===== Feature List ===== */
        .feature-list{list-style:none}
        .feature-list li{padding:10px 0;display:flex;align-items:flex-start;gap:12px;border-bottom:1px solid var(--gray-100);font-size:14px}
        .feature-list li:last-child{border-bottom:none}
        .feature-list li i{color:var(--success);font-size:15px;margin-top:3px}

        /* ===== Checkbox ===== */
        .checkbox-wrapper{display:flex;align-items:center;gap:10px;cursor:pointer;font-size:14px}
        .checkbox-wrapper input[type="checkbox"]{width:18px;height:18px;cursor:pointer;accent-color:var(--primary)}

        /* ===== Misc ===== */
        .helper-text{font-size:12px;color:var(--gray-500);margin-top:4px}
        .spinner{display:inline-block;width:18px;height:18px;border:2px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:spin .7s linear infinite}
        @keyframes spin{to{transform:rotate(360deg)}}
        .empty-state{text-align:center;padding:48px 24px;color:var(--gray-500)}
        .empty-state i{font-size:52px;margin-bottom:14px;color:var(--gray-300)}
        .empty-state h3{font-size:18px;font-weight:600;color:var(--dark);margin-bottom:6px}
        .empty-state p{font-size:14px}
        .badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}
        .badge-primary{background:var(--primary-light);color:var(--primary)}
        .badge-secondary{background:var(--gray-100);color:var(--gray-600)}
        .badge-success{background:var(--success-light);color:#15803d}
        .drop-zone{border:2px dashed var(--gray-300);border-radius:var(--radius-lg);padding:48px 24px;text-align:center;transition:all .2s;cursor:pointer;background:var(--gray-50)}
        .drop-zone:hover,.drop-zone.dragover{border-color:var(--primary);background:var(--primary-light)}
        .drop-zone i{font-size:48px;color:var(--gray-400);margin-bottom:16px}
        .drop-zone.dragover i{color:var(--primary)}
        .drop-zone p{color:var(--gray-500);font-size:14px}
        .pagination{display:flex;align-items:center;justify-content:center;gap:8px;flex-wrap:wrap}
        .page-btn{padding:8px 14px;border:1px solid var(--border);border-radius:var(--radius);color:var(--gray-600);text-decoration:none;font-size:14px;font-weight:500;transition:all .15s;background:var(--white)}
        .page-btn:hover{background:var(--primary-light);border-color:var(--primary);color:var(--primary)}
        .page-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
        footer{text-align:center;padding:20px 24px;color:var(--gray-400);border-top:1px solid var(--border);margin-top:32px;font-size:12px}

        /* ===== Responsive ===== */
        @media(max-width:1024px){
            .stats-grid{grid-template-columns:repeat(2,1fr)}
            .form-grid{grid-template-columns:1fr}
        }
        @media(max-width:768px){
            :root{--nav-w:280px}
            .sidebar{transform:translateX(-100%)}
            .sidebar.open{transform:translateX(0)}
            .main-content{margin-left:0}
            .mobile-menu-btn{display:flex}
            .topbar{padding:0 16px;height:56px}
            .topbar-title{font-size:16px}
            .page-content{padding:16px}
            .stats-grid{grid-template-columns:repeat(2,1fr);gap:10px}
            .stat-card{padding:16px}
            .stat-card h3{font-size:24px}
            .grid{grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
            .card{padding:16px;margin-bottom:12px}
            .quick-actions{grid-template-columns:repeat(3,1fr);gap:10px}
            .action-btn{padding:16px 8px;font-size:12px}
            .action-btn i{font-size:22px}
            th,td{padding:10px 12px;font-size:13px}
            .btn,button[type="submit"]{padding:12px 20px;font-size:15px;min-height:44px}
            input[type="text"],input[type="number"],input[type="datetime-local"],input[type="date"],input[type="time"],input[type="file"],select,textarea{padding:12px 14px;font-size:16px;min-height:44px}
            .hide-mobile{display:none}
        }
        @media(max-width:480px){
            .stats-grid{grid-template-columns:1fr 1fr;gap:8px}
            .stat-card h3{font-size:22px}
            .stat-card p{font-size:11px}
            .quick-actions{grid-template-columns:repeat(2,1fr)}
            .grid{grid-template-columns:1fr}
            .page-content{padding:12px}
            .card{padding:14px}
        }

    </style>
    <style>{% block extra_styles %}{% endblock %}</style>
    {% block extra_css %}{% endblock %}
</head>
<body>
<div class="app-layout">
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="/" class="sidebar-logo">
                <div class="sidebar-logo-icon"><img src="/static/images/logo.png" alt="CoE WU Logo"></div>
                <div class="sidebar-logo-text">Aeroponic DB<small>Snapshot Management</small></div>
            </a>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Main</div>
                <a href="/" class="nav-link {% if request.endpoint == 'index' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-home"></i> Dashboard</a>
                <a href="/upload" class="nav-link {% if request.endpoint == 'upload' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-cloud-upload-alt"></i> Upload</a>
                <a href="/query" class="nav-link {% if request.endpoint == 'query' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-search"></i> Search</a>
                <a href="/daily-snapshots" class="nav-link {% if request.endpoint == 'daily_snapshots' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-calendar-day"></i> Daily View</a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Media</div>
                <a href="/generate-video" class="nav-link {% if request.endpoint == 'generate_video' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-video"></i> Create Video</a>
                <a href="/videos" class="nav-link {% if request.endpoint == 'videos_list' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-film"></i> My Videos</a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Organize</div>
                <a href="/categories" class="nav-link {% if request.endpoint == 'categories' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-folder"></i> Categories</a>
                <a href="/import-drive" class="nav-link {% if request.endpoint == 'import_drive' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-file-import"></i> Import</a>
                <a href="/auto-sync" class="nav-link {% if request.endpoint == 'auto_sync' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-sync-alt"></i> Auto-Sync</a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">System</div>
                <a href="/stats" class="nav-link {% if request.endpoint == 'stats' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-chart-bar"></i> Statistics</a>
                <a href="/online" class="nav-link {% if request.endpoint == 'online_access' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-globe"></i> Online Access</a>
                <a href="/about" class="nav-link {% if request.endpoint == 'about' %}active{% endif %}" onclick="closeSidebar()"><i class="fas fa-info-circle"></i> About</a>
            </div>
        </nav>
        <div class="sidebar-footer">Aeroponic Snapshot DB &copy; 2026 by CoE WU</div>
    </aside>

    <div class="main-content">
        <header class="topbar">
            <div style="display:flex;align-items:center;gap:12px">
                <button class="mobile-menu-btn" id="menuBtn" onclick="toggleSidebar()" aria-label="Menu"><i class="fas fa-bars"></i></button>
                <h1 class="topbar-title">{% block page_title %}Dashboard{% endblock %}</h1>
            </div>
            <div style="display:flex;align-items:center;gap:8px">
                <a href="/upload" class="btn btn-sm" style="font-size:13px;padding:8px 16px"><i class="fas fa-plus"></i> <span class="hide-mobile">Upload</span></a>
            </div>
        </header>

        <div class="page-content">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    <i class="fas {% if category == 'success' %}fa-check-circle{% elif category == 'error' %}fa-exclamation-circle{% elif category == 'warning' %}fa-exclamation-triangle{% else %}fa-info-circle{% endif %}"></i>
                    <span>{{ message }}</span>
                </div>
                {% endfor %}
            {% endif %}
            {% endwith %}
            {% block content %}{% endblock %}
        </div>

        <footer>
            <p>Aeroponic Snapshot Database &mdash; Built by CoE WU Interns @ CCU</p>
        </footer>
    </div>
</div>
<script>
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('sidebarOverlay').classList.toggle('show')}
function closeSidebar(){document.getElementById('sidebar').classList.remove('open');document.getElementById('sidebarOverlay').classList.remove('show')}
window.addEventListener('resize',()=>{if(window.innerWidth>768)closeSidebar()});
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
